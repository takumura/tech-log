{"title":"NuxtJSã«Storybookã‚’å°å…¥ã™ã‚‹","date":"2021-01-04","category":"Vue","tag":["vue","nuxtjs","storybook"],"body":"\r\n\r\nNuxtJS + Electron ã‚’ä½¿ã£ã¦ã€ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã§å‹•ãã‚ªãƒ¬ã‚ªãƒ¬ Todo ã‚¢ãƒ—ãƒªã‚’ä½œã£ã¦ã¿ãŸããªã‚Šã¾ã—ãŸã€‚ã¾ãšã¯ NuxtJS(Vue.js)ã«æ…£ã‚Œã‚‹ãŸã‚ã®ã‚µãƒ³ãƒ—ãƒ« Todo ã‚¢ãƒ—ãƒªã‚’ä½œã‚Šã¾ã™ã€‚Storybook ã‚’å°å…¥ã—ã¦ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚«ã‚¿ãƒ­ã‚°ã‚‚ä½µã›ã¦ä½œã£ã¦ã¿ã¾ã™ã€‚\r\n\r\n## ç’°å¢ƒç¢ºèª\r\n\r\n- ã‚¨ãƒ‡ã‚£ã‚¿: VSCode\r\n- nodejs: v12.16.0\r\n- yarn: 1.22.4\r\n\r\n## ãƒ¯ãƒ¼ã‚¯ãƒ­ã‚°\r\n\r\n### yarn ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰\r\n\r\n```ps\r\n> yarn -v\r\n1.22.0\r\n\r\n> yarn policies set-version\r\nResolving latest to a url...\r\nDownloading https://github.com/yarnpkg/yarn/releases/download/v1.22.4/yarn-1.22.4.js...\r\nSaving it into C:\\Users\\takum\\.yarn\\releases\\yarn-1.22.4.js...\r\nUpdating C:\\Users\\takum/.yarnrc...\r\nDone!\r\n\r\n> yarn -v\r\n1.22.4\r\n```\r\n\r\n### NuxtJS ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ–°è¦ä½œæˆ\r\n\r\n`yarn create nuxt-app nuxt-components-storybook`ã«ã‚ˆã‚Š`create-nuxt-app`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒ global ã« install ã•ã‚Œã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç”ŸæˆãŒè¡Œã‚ã‚Œã¾ã—ãŸã€‚\r\n\r\nãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¨­å®šã§linting toolãªã©ãŠå¥½ã¿ã§é¸æŠã§ãã¾ã™ã€‚ä½•åº¦ã‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã£ã¦è©¦ã—ã¦ã¿ãŸçµæœã€ä»¥ä¸‹ã®è¨­å®šã«è½ã¡ç€ãã¾ã—ãŸã€‚\r\n\r\n```ps\r\n> yarn create nuxt-app nuxt-components-storybook\r\n\r\n> yarn create nuxt-app nuxt-components-storybook\r\nyarn create v1.22.4\r\n[1/4] Resolving packages...\r\n[2/4] Fetching packages...\r\n[3/4] Linking dependencies...\r\n[4/4] Building fresh packages...\r\n\r\nsuccess Installed \"create-nuxt-app@3.2.0\" with binaries:\r\n      - create-nuxt-app\r\n\r\ncreate-nuxt-app v3.2.0\r\nâœ¨  Generating Nuxt.js project in nuxt-components-storybook\r\n? Project name: nuxt-components-storybook\r\n? Programming language: TypeScript\r\n? Package manager: Yarn\r\n? UI framework: Vuetify.js\r\n? Nuxt.js modules: (Press <space> to select, <a> to toggle all, <i> to invert selection)\r\n? Linting tools: Prettier\r\n? Testing framework: Jest\r\n? Rendering mode: Single Page App\r\n? Deployment target: Static (Static/JAMStack hosting)\r\n? Development tools:\r\n\r\nyarn install v1.22.4\r\ninfo No lockfile found.\r\n\r\nğŸ‰  Successfully created project nuxt-components-storybook\r\n\r\n  To get started:\r\n\r\n        cd nuxt-components-storybook\r\n        yarn dev\r\n\r\n  To build & start for production:\r\n\r\n        cd nuxt-components-storybook\r\n        yarn build\r\n        yarn start\r\n\r\n  To test:\r\n\r\n        cd nuxt-components-storybook\r\n        yarn test\r\n\r\n\r\n  For TypeScript users.\r\n\r\n  See : https://typescript.nuxtjs.org/cookbook/components/\r\nDone in 502.43s.\r\n```\r\n\r\n### æœ€åˆã®å‹•ä½œç¢ºèª\r\n\r\ninstall å®Œäº†æ™‚ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å¾“ã„`yarn dev`ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€localhost:3000 ã§ã‚µã‚¤ãƒˆãŒèµ·å‹•ã—ã¾ã—ãŸã€‚\r\n\r\n```ps\r\n> yarn dev\r\nyarn run v1.22.4\r\n$ nuxt-ts\r\n\r\n   â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®\r\n   â”‚                                       â”‚\r\n   â”‚   Nuxt.js @ v2.14.1                   â”‚\r\n   â”‚                                       â”‚\r\n   â”‚   â–¸ Environment: development          â”‚\r\n   â”‚   â–¸ Rendering:   client-side          â”‚\r\n   â”‚   â–¸ Target:      static               â”‚\r\n   â”‚                                       â”‚\r\n   â”‚   Listening: http://localhost:3000/   â”‚\r\n   â”‚                                       â”‚\r\n   â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯\r\n\r\ni Preparing project for development                 12:44:00\r\ni Initial build may take a while                    12:44:00\r\nâˆš Builder initialized                               12:44:00\r\nâˆš Nuxt files generated                              12:44:01\r\n\r\nâˆš Client\r\n  Compiled successfully in 20.95s\r\n\r\ni Waiting for file changes                          12:44:32\r\ni Memory usage: 258 MB (RSS: 355 MB)                12:44:32\r\ni Listening on: http://localhost:3000/              12:44:32\r\nNo issues found.                                    12:44:32\r\n```\r\n\r\n### Storybook ã®å°å…¥\r\n\r\nstorybook cliã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€å„ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯/ãƒ„ãƒ¼ãƒ«å‘ã‘ã®åˆæœŸè¨­å®šãŒã§ãã‚‹ã‚ˆã†ã§ã™ã€‚`@storybook/cli`ã‚’devDependencies ã«è¿½åŠ ã€åˆæœŸåŒ–ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚\r\n\r\n```ps\r\nyarn add --dev @storybook/cli\r\nyarn sb init --type vue\r\n```\r\n\r\nãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç›´ä¸‹ã«`.storybook`ãƒ•ã‚©ãƒ«ãƒ€ã¨`stories`ãƒ•ã‚©ãƒ«ãƒ€ãŒä½œæˆã•ã‚Œã€`.storybook/main.js`ã¨ã„ãã¤ã‹ã®ã‚µãƒ³ãƒ—ãƒ«ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚‚ä½œæˆã•ã‚Œã¾ã—ãŸã€‚project.json ã«ã¯ storybook èµ·å‹•ç”¨ script ãŒè¿½åŠ ã•ã‚Œã¦ãŠã‚Šã€å®Ÿè¡Œã™ã‚‹ã¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ–ãƒ©ã‚¦ã‚¶ãŒèµ·å‹•ã—ã€localhost:6006 ã§ storybook ã®ã‚µã‚¤ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã—ãŸã€‚\r\n\r\n```ps\r\nyarn storybook\r\n```\r\n\r\n### vuetifyç”¨ã®è¨­å®šã‚’è¿½åŠ ã™ã‚‹\r\n\r\n[Nuxt + Vuetify ã®æ§‹æˆã§ Storybook ã‚’å°å…¥ã™ã‚‹](https://almond.milk200.cc/blog/2020/06/01/storybook.html)ã®è¨­å®šã‚’å‚è€ƒã«ã—ã¦ã€`preview.js`ã¨`webpack.config.js`ã‚’èª¿æ•´ã—ã¾ã—ãŸã€‚\r\n\r\n```js\r\n// .storybook/webpack.config.js\r\nconst path = require('path')\r\nconst rootPath = path.resolve(__dirname, '../')\r\n\r\nmodule.exports = ({ config }) => {\r\n  config.module.rules.push({\r\n    test: /\\.s(c|a)ss$/,\r\n    use: [\r\n      'style-loader',\r\n      'css-loader',\r\n      {\r\n        loader: 'sass-loader',\r\n      },\r\n    ],\r\n  })\r\n\r\n  config.resolve.alias['~'] = rootPath\r\n  config.resolve.alias['@'] = rootPath\r\n\r\n  return config\r\n}\r\n```\r\n\r\n```js\r\n// .storybook/preview.js\r\nimport { addDecorator } from '@storybook/vue'\r\nimport Vue from 'vue'\r\nimport Vuex from 'vuex'\r\n\r\nimport Vuetify from 'vuetify'\r\nimport { VApp, VContent } from 'vuetify/lib'\r\nimport colors from 'vuetify/es5/util/colors'\r\nimport 'vuetify/dist/vuetify.min.css'\r\n\r\nVue.use(Vuex)\r\nconst vuetifyOptions = {}\r\n\r\nVue.use(Vuetify, {\r\n  iconfont: 'mdi',\r\n  customVariables: ['~/assets/variables.scss'],\r\n  theme: {\r\n    dark: true,\r\n    themes: {\r\n      light: {\r\n        primary: colors.purple,\r\n        secondary: colors.grey.darken1,\r\n        accent: colors.shades.black,\r\n        error: colors.red.accent3,\r\n      },\r\n      dark: {\r\n        primary: colors.blue.darken2,\r\n        accent: colors.grey.darken3,\r\n        secondary: colors.amber.darken3,\r\n        info: colors.teal.lighten1,\r\n        warning: colors.amber.base,\r\n        error: colors.deepOrange.accent4,\r\n        success: colors.green.accent3,\r\n      },\r\n    },\r\n  },\r\n})\r\n\r\naddDecorator(() => ({\r\n  vuetify: new Vuetify(vuetifyOptions),\r\n  components: { VApp, VContent },\r\n  template: `<v-app><v-content><story/></v-content></v-app>`,\r\n}))\r\n\r\nexport const parameters = {\r\n  actions: { argTypesRegex: '^on[A-Z].*' },\r\n}\r\n```\r\n\r\n`Logo.vue`ã¨`WeatherCard.vue`ï¼ˆãƒ†ã‚¹ãƒˆç”¨ã«[Nuxt + Vuetify ã®æ§‹æˆã§ Storybook ã‚’å°å…¥ã™ã‚‹](https://almond.milk200.cc/blog/2020/06/01/storybook.html)ã®componentã‚’å€Ÿç”¨ï¼‰å‘ã‘ã«ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ä½œæˆã—ã¾ã—ãŸã€‚\r\n\r\n``` js\r\n// Logo.stories.js\r\nimport { storiesOf } from '@storybook/vue'\r\nimport Logo from '@/components/Logo.vue'\r\n\r\nstoriesOf('Components/Default', module).add(\r\n  'Logo',\r\n  () => ({\r\n    components: { Logo },\r\n    template: `\r\n    <logo />\r\n`,\r\n  }),\r\n  {\r\n    info: true,\r\n    notes: `\r\n        # Logo\r\n        Nuxt.js default logo\r\n      `,\r\n  },\r\n)\r\n```\r\n\r\n``` js\r\n// WeatherCard.stories.js\r\nimport WeatherCard from '../components/WeatherCard.vue'\r\n\r\nexport default {\r\n  title: 'Components/Vuetify',\r\n  component: WeatherCard,\r\n}\r\n\r\nconst Template = (args, { argTypes }) => ({\r\n  props: Object.keys(argTypes),\r\n  components: { WeatherCard },\r\n  template: '<weather-card :day-of-the-week-labels=\"dayOfTheWeekLabels\"/>',\r\n})\r\n\r\nexport const WeatherCardComponent = Template.bind({})\r\nWeatherCardComponent.args = {\r\n  dayOfTheWeekLabels: ['SU', 'MO', 'TU', 'WED', 'TH', 'FR', 'SA'],\r\n}\r\n```\r\n\r\n`WeatherCard.vue`ã§åˆ©ç”¨ã—ã¦ã„ã‚‹[Material Design Icon](https://material.io/resources/icons/?style=baseline)ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œãªã‹ã£ãŸã®ã§ã€`.storybook/preview-head.html`ã‚’è¿½åŠ ã€‚\r\n\r\n``` html\r\n<!-- .storybook/preview-head.html -->\r\n<link\r\n  href=\"https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900&display=swap\"\r\n  rel=\"stylesheet\"\r\n/>\r\n<link\r\n  href=\"https://cdn.jsdelivr.net/npm/@mdi/font@3.x/css/materialdesignicons.min.css\"\r\n  rel=\"stylesheet\"\r\n/>\r\n```\r\n\r\n## èª²é¡Œ\r\n\r\n### lint/formatã«ã¤ã„ã¦\r\n\r\nã“ã‚Œã¾ã§ Prettier ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼/ãƒªãƒ³ã‚¿ãƒ¼ã¨ã—ã¦ä½¿ã£ã¦ããŸã®ã§ã™ãŒã€vue ã®ãŠã™ã™ã‚ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆè¨­å®šãŒã‚ˆãã‚ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚eslint + prettierã®ã‚ˆã†ãªã®ã§ã™ãŒã€VSCode ã§ä¸€ç•ªäººæ°—ãŒã‚ã‚‹ vue ç”¨æ‹¡å¼µæ©Ÿèƒ½[Vetur](https://marketplace.visualstudio.com/items?itemName=octref.vetur)ã®æ¨™æº–ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼ã¯Prettier ã«ãªã£ã¦ã„ã¦ã€eslintã®æ¨å¥¨ã¨ç«¶åˆã™ã‚‹ã‚ˆã†ã«ãªã£ã¦ã—ã¾ã„ã¾ã—ãŸã€‚\r\n\r\nå„configã‚’èª¿æ•´ã—ã¦ã€eslintã¨prettierã‚’å…±å­˜ã•ã›ã‚‹è¨­å®šã«ã¤ã„ã¦è§£èª¬ã—ã¦ã„ã‚‹ã‚µã‚¤ãƒˆã‚’èª¿ã¹ãŸã‚Šã‚‚ã—ã¾ã—ãŸãŒã€ç§è‡ªèº«ã¯eslintã¸ã®ã“ã ã‚ã‚ŠãŒç„¡ã„ã®ã§prettierã«ã™ã¹ã¦ãŠä»»ã›ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚ã—ã°ã‚‰ãã“ã®ã¾ã¾é–‹ç™ºã‚’é€²ã‚ã€å•é¡Œç‚¹ãŒå‡ºã¦ããŸã‚‰ãã®ã¨ãè€ƒãˆã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚\r\n\r\n### vscodeã®formatterè¨­å®šã«ã¤ã„ã¦\r\n\r\nangularã¨vueã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’VSCodeã§é–‹ç™ºã™ã‚‹ã‚ˆã†ã«ãªã‚‹ã¨ã€VSCodeã®ã‚°ãƒ­ãƒ¼ãƒãƒ«è¨­å®šã§å…¨ã¦ã‚’ã¾ã‹ãªã†ã®ã¯é›£ã—ã„ã‚ˆã†ã«æ„Ÿã˜ã¾ã—ãŸã€‚ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®è¨­å®šã¯æœ€ä½é™ã®å…±é€šäº‹é …ã«ç•™ã‚ã€å„ç¨®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å¿…è¦ãªè¨­å®šã‚’å€‹åˆ¥ã«é©ç”¨ã—ãŸæ–¹ãŒè‰¯ã•ãã†ã§ã™ã€‚\r\n\r\nãªã®ã§VSCodeã®è¨­å®šã‚’ã€å…±é€š / angularç”¨ / vueç”¨ã§åˆ†å‰²ã™ã‚‹äºˆå®šã§ã™ã€‚\r\n\r\n## é–¢é€£é …ç›®\r\n\r\n- [Vue.js official](https://vuejs.org/)\r\n- [awesome-vue - Github](https://github.com/vuejs/awesome-vue)\r\n- [Vue CLI official](https://cli.vuejs.org/)\r\n- [How to use Vue.js with Electron and Vuex](https://www.digitalocean.com/community/tutorials/vuejs-vue-electron)\r\n- [Nuxt.js official](https://nuxtjs.org/)\r\n- [ESLint ã¨ Prettier - NuxtJS](https://ja.nuxtjs.org/guide/development-tools/#eslint-%E3%81%A8-prettier)\r\n- [An (almost) comprehensive guide on using Storybook with Nuxt.js](https://medium.com/js-dojo/a-guide-on-using-storybook-with-nuxt-js-1e0018ec51c9)\r\n- [Storybook for Vue](https://storybook.js.org/docs/guides/guide-vue/)\r\n- [Nuxt + Vuetify ã®æ§‹æˆã§ Storybook ã‚’å°å…¥ã™ã‚‹](https://almond.milk200.cc/blog/2020/06/01/storybook.html)\r\n- [Story rendering - Storybook](https://storybook.js.org/docs/react/configure/story-rendering#adding-to-head)\r\n"}